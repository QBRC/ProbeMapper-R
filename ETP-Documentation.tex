% 
\documentclass[a4paper]{article}
\usepackage[OT1]{fontenc}
\usepackage{Sweave}
\begin{document}

\title{Entrez To Probe (ETP) Package}
\author{Jeffrey D. Allen}

\maketitle

We'll first need to setup our environment and establish a connection.

\begin{Schunk}
\begin{Sinput}
> library(rjson)
> source("ETP.R")
> conn <- etp.connect("http://qbridev.swmed.edu/etp/", "68BC9124A0A8BE32")
\end{Sinput}
\end{Schunk}

\section{Getting Gene or Probe Information}

The \verb/ETP/ package can be used to get information from the Entrez databse about a Gene, or to convert between Vendor probe annotations and our internal probeIDs.

\subsection{Get Information on a Gene}

To lookup information on a gene, you must specify the EntrezID of that gene.

\begin{Schunk}
\begin{Sinput}
> gene780 <- etp.getGene(conn, entrezID = 780)
> gene780
\end{Sinput}
\begin{Soutput}
$`780`
$`780`$name
[1] "discoidin domain receptor tyrosine kinase 1"

$`780`$description
[1] "discoidin domain receptor tyrosine kinase 1"

$`780`$symbols
[1] "DDR1,CAK,CD167,DDR,EDDR1,HGK2,MCK10,NEP,NTRK4,PTK3,PTK3A,RTK6,TRKE"

$`780`$accessions
[1] "AL805917.3,CR753093.2,CR936875.3,X99031.1,AAC50917.1,U48705.1,BAB63318.1,BA000025.2,BAC54935.1,AB088102.1,BAE78621.1,AB202100.1,BAF31270.1,AB103608.1,CAA66871.1,X98208.1,CAI17433.1,AL662854.7,CAI17434.1,AL662854.7,CAI18441.1,AL662870.16,CAI18442.1,AL662870.16,CAI18450.1,AL773541.6,CAI18451.1,AL773541.6,CAI18533.1,AL773589.3,CAI18534.1,AL773589.3,CAQ06756.1,CR759747.7,CAQ06757.1,CR759747.7,CAQ07770.1,CR936908.2,CAQ07771.1,CR936908.2,CAQ09767.1,BX927194.9,CAQ09768.1,BX927194.9,CAX15129.1,CR942271.10,CAX15130.1,CR942271.10,CAX15131.1,CR942271.10,CAX15132.1,CR942271.10,CAX15133.1,CR942271.10,CAX15134.1,CR942271.10,CAX15135.1,CR942271.10,EAX03335.1,CH471081.1,EAX03336.1,CH471081.1,EAX03337.1,CH471081.1,EAX03338.1,CH471081.1,EAX03339.1,CH471081.1,EAX03340.1,CH471081.1,EAX03341.1,CH471081.1,EAX03342.1,CH471081.1,EAX03343.1,CH471081.1,EAX03344.1,CH471081.1,EAX03345.1,CH471081.1,EAX03346.1,CH471081.1,Q08345.1,Q6ZNR9,Q96T62,AB210021.1,BAE06103.1,AF353182.1,AAK48842.1,AK130776.1,BAC85426.1,AK291621.1,BAF84310.1,AK294793"
\end{Soutput}
\end{Schunk}

\subsection{List the Available Platforms}

All functions that references a platform require that you reference the platform by its numerical ID. In order to lookup that ID, you can list out all the available platforms and find the one in which you're interested:

\begin{Schunk}
\begin{Sinput}
> platforms <- etp.getPlatforms(conn)
> platforms
\end{Sinput}
\begin{Soutput}
                                   name manufacturer
1                             AffyU133A   Affymetrix
2                         AffyU133Plus2   Affymetrix
3               AffyHG-FocusTargetArray   Affymetrix
4               AffyHumanExon1.0STArray   Affymetrix
5                              AffyU95A   Affymetrix
6                            AffyHu6800   Affymetrix
7                      IlluminaHuman6v1     Illumina
8                      IlluminaHuman6v2     Illumina
9                    AgilentHumanG4112F      Agilent
10   AgilentHomosapiens21.6Kcustomarray      Agilent
11                   AgilentHumanG4112A      Agilent
12 Agilent44Kwholegenomelowdensityarray      Agilent
13             Agilent-UNC-custom-4X44K      Agilent
14                           AffyU95Av2   Affymetrix
15                            AffyU133B   Affymetrix
16  PRHU05-S1-0006(PCHumanOperonv2_21k)             
17                            cDNAarray             
18                     IlluminaHuman6v3     Illumina
\end{Soutput}
\end{Schunk}

\subsection{Get Information on a Probe}

To lookup information on a probe, you can either specify the probe ID which we've created internally:

\begin{Schunk}
\begin{Sinput}
> probe <- etp.getProbe(conn, probeID = 1000008)
> probe
\end{Sinput}
\begin{Soutput}
$`1000008`
$`1000008`$name
[1] "1320_at"

$`1000008`$platform
[1] 1
\end{Soutput}
\end{Schunk}

Or you can reference it by its platform ID plus the name assigned to this probeset by  the vendor.

\begin{Schunk}
\begin{Sinput}
> probe <- etp.getProbe(conn, platformID = 1, probeName = "1007_s_at")
> probe
\end{Sinput}
\begin{Soutput}
$`1000001`
$`1000001`$name
[1] "1007_s_at"

$`1000001`$platform
[1] 1
\end{Soutput}
\end{Schunk}

\section{Mapping Between Genes and Probes}

\subsection{Probe To Genes}

You can use this package to find out which genes are associated with a certain probe. To see all of the associations, you can reference the probe by its probeID, or by the platform ID + probe name as specified earlier:

\begin{Schunk}
\begin{Sinput}
> genes <- etp.getGenesByProbe(conn, probeID = 2043812)
> genes <- etp.getGenesByProbe(conn, platformID = 2, probeName = "234562_x_at")
> genes
\end{Sinput}
\begin{Soutput}
$probe
$probe$id
[1] 2043812

$probe$name
[1] "234562_x_at"

$probe$platform
[1] 2


$genes
                                                          name
8647   ATP-binding cassette, sub-family B (MDR/TAP), member 11
57188                                            ADAMTS-like 3
63827                                                 brevican
387535                                                      NA
645644                                                      NA
728678                                                      NA
                                                   description
8647   ATP-binding cassette, sub-family B (MDR/TAP), member 11
57188                                            ADAMTS-like 3
63827                                                 brevican
387535                  hepatocellular carcinoma-related HCRP1
645644                                  hypothetical LOC645644
728678                                                      NA
                                              symbols
8647   ABCB11,ABC16,BRIC2,BSEP,PFIC-2,PFIC2,PGY4,SPGP
57188           ADAMTSL3,KIAA1233,MGC150716,MGC150717
63827                       BCAN,BEHAB,CSPG7,MGC13038
387535                                          HCRP1
645644             FLJ42627,FLJ12913,FLJ44722,MGC4278
728678                                             NA
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             accessions
8647                                                                                                                                                                                                                                                                                                                                                                                                                                                            AC093723.2,AAY24100.1,AC069137.6,AAY24305.1,AC008177.3,CAI54162.1,CS016617.1,EAX11285.1,CH471058.2,EAX11286.1,CH471058.2,EAX11287.1,CH471058.2,O95342.2,Q53S60,Q9UIL3,AB012959.1,BAA88711.1,AF091582.1,AAC77455.1,AF136523.1,AAD28285.1,AK302540.1,BAG63812.1,AK303050.1,BAG64170.1,NG_007374.1,NM_003742.2,NP_003733.2,AC_000045.1,NM_003742.2,NP_003733.2,AC_000134.1,NM_003742.2,NP_003733.2,NC_000002.11,NM_003742.2,NP_003733.2,NG_007374.1,NM_003742.2,NP_003733.2,NT_005403.17,NM_003742.2,NP_003733.2,NW_001838860.1,NM_003742.2,NP_003733.2,NW_003315909.1,NM_003742.2,NP_003733.2,NW_921585.1
57188                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             AC027807.6,AC087738.13,AC116157.4,EAW62418.1,CH471188.1,P82987.4,AB033059.1,BAA86547.1,AF237652.1,AAK15041.1,AK092324.1,AK308845.1,AL109723.1,AL109724.1,BC128389.1,AAI28390.1,BC128390.1,AAI28391.1,BE646238.1,CR621245.1,NM_207517.2,NP_997400.2,AC_000058.1,NM_207517.2,NP_997400.2,AC_000147.1,NM_207517.2,NP_997400.2,NC_000015.9,NM_207517.2,NP_997400.2,NT_077661.3,NM_207517.2,NP_997400.2,NW_001838221.1,NM_207517.2,NP_997400.2,NW_925918.1
63827  CAI13056.1,AL365181.24,CAI13057.1,AL365181.24,CAI13058.1,AL365181.24,CAI13059.1,AL365181.24,CAI13060.1,AL365181.24,CAI16352.1,AL590666.8,EAW52927.1,CH471121.2,EAW52928.1,CH471121.2,EAW52929.1,CH471121.2,EAW52930.1,CH471121.2,EAW52931.1,CH471121.2,Q59F90,Q5T3I7,Q5T3I8,Q8IWX2,Q96GW7.2,Q9NT67,AB209570.1,BAD92807.1,AF228710.1,AAG23134.1,AF229053.1,AAG23135.1,AK126588.1,AK289759.1,BAF82448.1,AL137504.1,CAB70776.1,AW298823.1,AY007241.1,AAG01897.1,AY358372.1,AAQ88738.1,BC005081.1,BC009117.1,AAH09117.1,BC010117.2,BC010571.1,BC013234.1,BC022938.1,AAH22938.1,BC023209.1,BC027971.1,AAH27971.1,BC029313.1,BC029348.1,BC035457.1,NM_021948.3,NP_068767.3,AC_000044.1,NM_021948.3,NP_068767.3,AC_000133.1,NM_021948.3,NP_068767.3,NC_000001.10,NM_021948.3,NP_068767.3,NT_004487.19,NM_021948.3,NP_068767.3,NW_001838531.2,NM_021948.3,NP_068767.3,NW_925683.1,NM_198427.1,NP_940819.1,AC_000044.1,NM_198427.1,NP_940819.1,AC_000133.1,NM_198427.1,NP_940819.1,NC_000001.10,NM_198427.1,NP_940819.1,NT_004487.19,NM_198427.1,NP_940819.1,NW_001838531
387535                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AL138735.7,Q6S5B2,AK025343.1,AY465895.1,AAR27958.1,XM_001722898.2,XP_001722950.1,AC_000049.1,XM_001722898.2,XP_001722950.1,NW_923073.1,XM_001725456.2,XP_001725508.1,NC_000006.11,XM_001725456.2,XP_001725508.1,NT_007592.15
645644                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AC141586.2,AK022975.1,AK124618.1,AK126677.1,BC002659.1,NR_024492.1,AC_000148.1,NR_024492.1,NC_000016.9,NR_024492.1,NT_010393.16,NR_024492.1,NW_001838339.2,NR_024492.1,NW_926094.1,NR_024492.1,NW_927477.1
728678                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               NA
           BLAST Vendor Bioconductor
8647   0.0302755      0            0
57188  0.0757342      0            0
63827  0.0909174      0            0
387535  0.712156      0            0
645644 0.0909174      0            0
728678         0      1            0
\end{Soutput}
\end{Schunk}

You can also filter to a certain authority. ``Authority'' here means the source of the association. For instance, our 3 current authorities are BLAST (=1), Vendor's Annotations (=2), and Bioconductor (=3).

So to find the genes associated with this probe according to the vendor and BLAST, you would run:

\begin{Schunk}
\begin{Sinput}
> genes <- etp.getGenesByProbe(conn, probeID = 2043812, authorityID = c(1, 
+     2))
> genes
\end{Sinput}
\begin{Soutput}
$probe
$probe$id
[1] 2043812

$probe$name
[1] "234562_x_at"

$probe$platform
[1] 2


$genes
                                                          name
8647   ATP-binding cassette, sub-family B (MDR/TAP), member 11
57188                                            ADAMTS-like 3
63827                                                 brevican
387535                                                      NA
645644                                                      NA
728678                                                      NA
                                                   description
8647   ATP-binding cassette, sub-family B (MDR/TAP), member 11
57188                                            ADAMTS-like 3
63827                                                 brevican
387535                  hepatocellular carcinoma-related HCRP1
645644                                  hypothetical LOC645644
728678                                                      NA
                                              symbols
8647   ABCB11,ABC16,BRIC2,BSEP,PFIC-2,PFIC2,PGY4,SPGP
57188           ADAMTSL3,KIAA1233,MGC150716,MGC150717
63827                       BCAN,BEHAB,CSPG7,MGC13038
387535                                          HCRP1
645644             FLJ42627,FLJ12913,FLJ44722,MGC4278
728678                                             NA
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             accessions
8647                                                                                                                                                                                                                                                                                                                                                                                                                                                            AC093723.2,AAY24100.1,AC069137.6,AAY24305.1,AC008177.3,CAI54162.1,CS016617.1,EAX11285.1,CH471058.2,EAX11286.1,CH471058.2,EAX11287.1,CH471058.2,O95342.2,Q53S60,Q9UIL3,AB012959.1,BAA88711.1,AF091582.1,AAC77455.1,AF136523.1,AAD28285.1,AK302540.1,BAG63812.1,AK303050.1,BAG64170.1,NG_007374.1,NM_003742.2,NP_003733.2,AC_000045.1,NM_003742.2,NP_003733.2,AC_000134.1,NM_003742.2,NP_003733.2,NC_000002.11,NM_003742.2,NP_003733.2,NG_007374.1,NM_003742.2,NP_003733.2,NT_005403.17,NM_003742.2,NP_003733.2,NW_001838860.1,NM_003742.2,NP_003733.2,NW_003315909.1,NM_003742.2,NP_003733.2,NW_921585.1
57188                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             AC027807.6,AC087738.13,AC116157.4,EAW62418.1,CH471188.1,P82987.4,AB033059.1,BAA86547.1,AF237652.1,AAK15041.1,AK092324.1,AK308845.1,AL109723.1,AL109724.1,BC128389.1,AAI28390.1,BC128390.1,AAI28391.1,BE646238.1,CR621245.1,NM_207517.2,NP_997400.2,AC_000058.1,NM_207517.2,NP_997400.2,AC_000147.1,NM_207517.2,NP_997400.2,NC_000015.9,NM_207517.2,NP_997400.2,NT_077661.3,NM_207517.2,NP_997400.2,NW_001838221.1,NM_207517.2,NP_997400.2,NW_925918.1
63827  CAI13056.1,AL365181.24,CAI13057.1,AL365181.24,CAI13058.1,AL365181.24,CAI13059.1,AL365181.24,CAI13060.1,AL365181.24,CAI16352.1,AL590666.8,EAW52927.1,CH471121.2,EAW52928.1,CH471121.2,EAW52929.1,CH471121.2,EAW52930.1,CH471121.2,EAW52931.1,CH471121.2,Q59F90,Q5T3I7,Q5T3I8,Q8IWX2,Q96GW7.2,Q9NT67,AB209570.1,BAD92807.1,AF228710.1,AAG23134.1,AF229053.1,AAG23135.1,AK126588.1,AK289759.1,BAF82448.1,AL137504.1,CAB70776.1,AW298823.1,AY007241.1,AAG01897.1,AY358372.1,AAQ88738.1,BC005081.1,BC009117.1,AAH09117.1,BC010117.2,BC010571.1,BC013234.1,BC022938.1,AAH22938.1,BC023209.1,BC027971.1,AAH27971.1,BC029313.1,BC029348.1,BC035457.1,NM_021948.3,NP_068767.3,AC_000044.1,NM_021948.3,NP_068767.3,AC_000133.1,NM_021948.3,NP_068767.3,NC_000001.10,NM_021948.3,NP_068767.3,NT_004487.19,NM_021948.3,NP_068767.3,NW_001838531.2,NM_021948.3,NP_068767.3,NW_925683.1,NM_198427.1,NP_940819.1,AC_000044.1,NM_198427.1,NP_940819.1,AC_000133.1,NM_198427.1,NP_940819.1,NC_000001.10,NM_198427.1,NP_940819.1,NT_004487.19,NM_198427.1,NP_940819.1,NW_001838531
387535                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AL138735.7,Q6S5B2,AK025343.1,AY465895.1,AAR27958.1,XM_001722898.2,XP_001722950.1,AC_000049.1,XM_001722898.2,XP_001722950.1,NW_923073.1,XM_001725456.2,XP_001725508.1,NC_000006.11,XM_001725456.2,XP_001725508.1,NT_007592.15
645644                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AC141586.2,AK022975.1,AK124618.1,AK126677.1,BC002659.1,NR_024492.1,AC_000148.1,NR_024492.1,NC_000016.9,NR_024492.1,NT_010393.16,NR_024492.1,NW_001838339.2,NR_024492.1,NW_926094.1,NR_024492.1,NW_927477.1
728678                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               NA
           BLAST Vendor
8647   0.0302755      0
57188  0.0757342      0
63827  0.0909174      0
387535  0.712156      0
645644 0.0909174      0
728678         0      1
\end{Soutput}
\end{Schunk}

You'll notice that the ``Bioconductor'' column disappears, since we're not interested in it according to the query we ran.

\subsection{Gene to Probes}

You can also specify a gene and find the relevant probes.

\begin{Schunk}
\begin{Sinput}
> probes <- etp.getProbesByGene(conn, entrezID = 780)
> probes
\end{Sinput}
\begin{Soutput}
$gene
$gene$id
[1] 780

$gene$name
[1] "discoidin domain receptor tyrosine kinase 1"

$gene$description
[1] "discoidin domain receptor tyrosine kinase 1"

$gene$symbols
[1] "DDR1,CAK,CD167,DDR,EDDR1,HGK2,MCK10,NEP,NTRK4,PTK3,PTK3A,RTK6,TRKE"

$gene$accessions
[1] "AL805917.3,CR753093.2,CR936875.3,X99031.1,AAC50917.1,U48705.1,BAB63318.1,BA000025.2,BAC54935.1,AB088102.1,BAE78621.1,AB202100.1,BAF31270.1,AB103608.1,CAA66871.1,X98208.1,CAI17433.1,AL662854.7,CAI17434.1,AL662854.7,CAI18441.1,AL662870.16,CAI18442.1,AL662870.16,CAI18450.1,AL773541.6,CAI18451.1,AL773541.6,CAI18533.1,AL773589.3,CAI18534.1,AL773589.3,CAQ06756.1,CR759747.7,CAQ06757.1,CR759747.7,CAQ07770.1,CR936908.2,CAQ07771.1,CR936908.2,CAQ09767.1,BX927194.9,CAQ09768.1,BX927194.9,CAX15129.1,CR942271.10,CAX15130.1,CR942271.10,CAX15131.1,CR942271.10,CAX15132.1,CR942271.10,CAX15133.1,CR942271.10,CAX15134.1,CR942271.10,CAX15135.1,CR942271.10,EAX03335.1,CH471081.1,EAX03336.1,CH471081.1,EAX03337.1,CH471081.1,EAX03338.1,CH471081.1,EAX03339.1,CH471081.1,EAX03340.1,CH471081.1,EAX03341.1,CH471081.1,EAX03342.1,CH471081.1,EAX03343.1,CH471081.1,EAX03344.1,CH471081.1,EAX03345.1,CH471081.1,EAX03346.1,CH471081.1,Q08345.1,Q6ZNR9,Q96T62,AB210021.1,BAE06103.1,AF353182.1,AAK48842.1,AK130776.1,BAC85426.1,AK291621.1,BAF84310.1,AK294793"


$probes
                name platform BLAST Vendor Bioconductor
1000001    1007_s_at        1     1      1            1
1006695  207169_x_at        1     1      1            1
1008274  208779_x_at        1     1      1            1
1010210  210749_x_at        1     1      1            1
1030008    1007_s_at        5     1      1            1
1036697     36643_at        5     1      1            1
1123984 A_24_P367289       11     1      1            1
1132175 A_24_P123601       11     1      1            1
1142784  A_23_P93311       11     0      1            1
1220552  A_23_P93311        9     0      1           NA
1228705 A_24_P367289        9     1      1           NA
1233864 A_24_P123601        9     1      1           NA
1306237 ILMN_1812262       18     1      1            1
1312855 ILMN_2290547       18     1      1            1
1337400 ILMN_2360054       18     1      1            1
2000001    1007_s_at        2     1      1            1
2016616  207169_x_at        2     1      1            1
2018195  208779_x_at        2     1      1            1
2020131  210749_x_at        2     1      1            1
7001071      3360594        7     1     NA            0
7004647      6620193        7     1     NA            0
8020216 ILMN_1812262        8     1      1            1
\end{Soutput}
\end{Schunk}

Again you can filter by authority, but you can also filter by platform. To see only the probes associated with Affymetrix U133A (platform \#1), you would run:

\begin{Schunk}
\begin{Sinput}
> probes <- etp.getProbesByGene(conn, entrezID = 780, authorityID = 2, 
+     platformID = 1)$probes
> probes
\end{Sinput}
\begin{Soutput}
               name platform Vendor
1000001   1007_s_at        1      1
1006695 207169_x_at        1      1
1008274 208779_x_at        1      1
1010210 210749_x_at        1      1
\end{Soutput}
\end{Schunk}

\subsection{Missing Data}

You may notice some values of \verb/NA/ while mapping between genes and probes. This is because not all information is available from every authority. For instance, Agilent G4112F is not available on Bioconductor, and Illumina did not give an Entrez ID in their v1 platform. Thus you'll find results like:

\begin{Schunk}
\begin{Sinput}
> etp.getProbesByGene(conn, 57188)$probes
\end{Sinput}
\begin{Soutput}
                name platform     BLAST Vendor Bioconductor
1013353    213974_at        1         1      1            1
1038932     38856_at        5         1      1            1
1130747  A_23_P43940       11         1      1            1
1143930 A_23_P308974       11         1      1            1
1155476 A_24_P400842       11         1      1            1
1201213 A_24_P400842        9         1      1           NA
1202372 A_23_P308974        9         1      1           NA
1212826  A_23_P43940        9         1      1           NA
1300959 ILMN_1798690       18         1      1            1
2004979   1559748_at        2         1      1            1
2023274    213974_at        2         1      1            1
2043812  234562_x_at        2 0.0757342      0            0
7031005      3130403        7         1     NA            0
8021599 ILMN_1798690        8         1      1            1
\end{Soutput}
\end{Schunk}

with rows such as:

\begin{Schunk}
\begin{Sinput}
> etp.getProbesByGene(conn, 57188)$probes[6, ]
\end{Sinput}
\begin{Soutput}
                name platform BLAST Vendor Bioconductor
1201213 A_24_P400842        9     1      1           NA
\end{Soutput}
\end{Schunk}

which produces an \verb/NA/ value for Bioconductor because that information is not available.

\end{document}
